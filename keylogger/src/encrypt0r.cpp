#include "encrypt0r.h"

#include <iostream>
#include <crypto++/aes.h>
#include <crypto++/modes.h>
#include <crypto++/files.h>
#include <crypto++/cryptlib.h>

void encryptFile(const CryptoPP::SecByteBlock& key, const CryptoPP::SecByteBlock& iv,
                 const std::string& inputFile, const std::string& outputFile) {
    try {
        CryptoPP::CBC_Mode<CryptoPP::AES>::Encryption encryptor;
        encryptor.SetKeyWithIV(key, key.size(), iv);

        CryptoPP::FileSource fileSource(inputFile.c_str(), true,
            new CryptoPP::StreamTransformationFilter(encryptor,
                new CryptoPP::FileSink(outputFile.c_str())
            )
        );

        std::cout << "File encrypted successfully." << std::endl;
    } catch (const CryptoPP::Exception& e) {
        std::cerr << "Error: " << e.what() << std::endl;
    }
}
